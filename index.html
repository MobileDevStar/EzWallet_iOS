<!doctype html>
<html>

<head>
<meta charset="UTF-8">
<title>Inspec Safety Wallet</title>
<!-- Page Cache -->
<meta content="max-age=0" http-equiv="cache-control">
<meta content="no-cache" http-equiv="cache-control">
<meta content="0" http-equiv="expires">
<meta content="Tue, 01 Jan 1990 1:00:00 GMT" http-equiv="expires">
<meta content="no-cache" http-equiv="pragma">
<!-- Robots -->
<meta content="noindex,nofollow" name="robots">
<!-- CSS -->
<meta content="width=device-width, initial-scale=1" name="viewport">
<link href="https://www.w3schools.com/w3css/4/w3pro.css" rel="stylesheet">
</head>

<body onload="onLoadPage();">

<div class="w3-cell w3-container">
	<table align="center" border="0" cellpadding="3" cellspacing="0" width="100%">
		<tr>
			<td>
			<img alt="Inspec Safety Wallet" height="148" longdesc="Inspec Safety Wallet Logo" src="images/logo.png" width="330"></td>
		</tr>
		<tr>
			<td>
			<form id="login" action="" autocomplete="off" class="login-form" method="post">
				<fieldset>
				<legend>Login</legend>
				<div class="row">
					<input id="username" class="field" name="user" style="width: 200px" type="text" value="">
				</div>
				<div class="row">
				</div>
				<div class="row">
					<input id="password" class="field" name="pwd" style="width: 200px" type="password" value="">
				</div>
				<div class="row">
					<input class="button" type="submit" value="Submit"> 
				</div>
				<!-- <div class="row">
					<input class="button" type="button" value="Load" onclick="onLoadPage();"> 
				</div> -->
					<!-- <input class="button" type="button" value="Submit" onclick="onClickSubmit()"> </div> -->
				</fieldset>
			</form>
			</td>
		</tr>
		<tr>
			<td>Don't have an Account?
			<a href="https://111.datatrium.com/fmi/webd/webd/ezwallet">Register 
			here.</a></td>
		</tr>
	</table>
	<!-- JavaScript -->
	<script type="text/javascript">
		var webdirectHome = 'https://111.datatrium.com/index.html';
		var webdirectURL = 'https://111.datatrium.com/fmi/webd/ezwallet?homeurl='+webdirectHome;
		document.getElementById('login').action = webdirectURL;

		document.addEventListener('submit', function(e) {
			//e.preventDefault();
			console.log('Form submitted');
			
			if (window.JSInterface) {
				saveUserAndroid();
			} else if (window.webkit) {
				saveUserIOS();
			}
		});

		function onLoadPage() {
			if (window.JSInterface) {
				loadUserAndroid();
			} else if (window.webkit) {
				loadUserIOS();
			}
		}

		function saveUserIOS() {
			var username = document.getElementById('username').value;
			var password = document.getElementById('password').value;
			window.webkit.messageHandlers.EzWalletApi.postMessage('save,' + username + ',' + password);
		}

		function loadUserIOS() {
			window.webkit.messageHandlers.EzWalletApi.postMessage('load,username,password');
		}

		function setSavedUserIOS(username, password) {
			document.getElementById('username').value = username;
			document.getElementById('password').value = password;
		}

		//function save
		function saveUserAndroid(){
			var username = document.getElementById('username').value;
			var password = document.getElementById('password').value;
			JSInterface.savePreferences(username, password);
		}

		function loadUserAndroid(){
			var username = JSInterface.loadPreferences("username");
			var password = JSInterface.loadPreferences("password");

			document.getElementById('username').value = username;
			document.getElementById('password').value = password;

//			showAndroidToast("Username: " + username + "\nPassword: " + password);
		}

		function showAndroidToast(toast) {
			JSInterface.showToast(toast);
		}

	</script>
</div>

</body>

</html>
